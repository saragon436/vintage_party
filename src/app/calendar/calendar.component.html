<!-- <div id="formulario">
  <div>
    <button (click)="exportToExcel()">Exportar a Excel</button>
  </div>
  <div class="vertical-container">
    <table #table>
      <tr>
        <th width="10%">Día</th>
        <th width="15%">Código de Contrato</th>
        <th width="20%">Usuario</th>
        <th width="10%">Horario</th>
        <th width="11%">Distrito</th>
        <th width="50%">Direccion</th>
      </tr>
      <tr *ngFor="let day of week; let i = index">
        <td>{{ nombresDias[i] }} {{ day | date: 'd' }} de {{ nombresMeses[day.getMonth()] }} de {{ day.getFullYear() }}</td>
        <td>

          <li *ngFor="let contract of getContractsForDay(day)">
            <ul>
              <div class="contract">{{ contract.codContract}}</div>
            </ul>
          </li>

        </td>
        <td>

          <li *ngFor="let contract of getContractsForDay(day)">
            <ul>
              <div class="contract">{{ contract.customer.name }}</div>
            </ul>
          </li>

        </td>
        <td>

          <li *ngFor="let contract of getContractsForDay(day)">
            <ul>
              <div class="contract">{{contract.hourIni}}-{{contract.hourFin}}</div>
            </ul>
          </li>

        </td>
        <td>

          <li *ngFor="let contract of getContractsForDay(day)">
            <ul>
              <div class="contract">{{ contract.district }}</div>
            </ul>
          </li>

        </td>
        <td>

          <li *ngFor="let contract of getContractsForDay(day)">
            <ul>
              <div class="contract">{{ contract.address }}</div>
            </ul>
          </li>

        </td>

      </tr>
    </table>
  </div>
</div> -->
<div id="formulario">
  <div>
    <button class="btn btn-primary" (click)="exportToExcel()">Exportar a Excel</button>
  </div>
  <div class="vertical-container">
    <table #table>
      <tr>
        <th width="10%">Fecha</th>
        <th width="15%">Código de Contrato</th>
        <th width="20%">Usuario</th>
        <th width="10%">Horario</th>
        <th width="11%">Distrito</th>
        <th width="50%">Direccion</th>
      </tr>
      <ng-container *ngFor="let day of week; let i = index">
        <tr>
          <td [attr.rowspan]="getContractsForDay(day).length + 1">
            {{ nombresDias[i] }} {{ day | date: 'd' }} de {{ nombresMeses[day.getMonth()] }} de {{ day.getFullYear() }}
          </td>
        </tr>
        <tr *ngFor="let contract of getContractsForDay(day)">
          <td><div class="contract">{{ contract.codContract }}</div></td>
          <td>{{ contract.customer.name }}</td>
          <td>{{ contract.hourIni }}-{{ contract.hourFin }}</td>
          <td>{{ contract.district }}</td>
          <td>{{ contract.address }}</td>
        </tr>
      </ng-container>
    </table>
  </div>
</div>
