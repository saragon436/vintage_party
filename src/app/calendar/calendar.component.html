<div id="formulario">
  <div>
    <button class="btn btn-primary" (click)="exportToExcel()">Exportar a Excel</button>
  </div>
  <div id="salto"></div>
  <div class="vertical-container">
    <table #table>
      <tr>
        <th width="10%">Fecha</th>
        <th width="10%">Boton</th>
        <th width="10%">Orden</th>
        <th width="15%">CÃ³digo de Contrato</th>
        <th width="20%">Usuario</th>
        <th width="10%">Horario</th>
        <th width="10%">Mobilidad</th>
        <th width="11%">Distrito</th>
        <th width="50%">Direccion</th>
        <th width="50%">Estado</th>
      </tr>
      <ng-container *ngFor="let day of week; let i = index">
        <tr>
          <td [attr.rowspan]="getContractsForDay(day).length + 3 + getContractsPikupDateForDay(day).length">
            {{ nombresDias[i] }} {{ day | date: 'd' }} de {{ nombresMeses[day.getMonth()] }} de {{ day.getFullYear() }}
          </td>
        </tr>
        <tr>
          <td style="background-color: rgb(219, 96, 203);">Entrega</td>
          <div>
            <button class="btn btn-primary" (click)="onOptionChangeOrder(getContractsForDay(day));onOptionChangeOrderPickup(getContractsPikupDateForDay(day))">Guardar Orden</button>
          </div>
        </tr>
        <tr *ngFor="let contract of getContractsForDay(day); let i = index" [class.yellow-background]="contract.isSelected">
          <td>
            <button class="btn btn-warning" (click)="moveRowUp(day,contract)">Subir</button>
            <button class="btn btn-warning" (click)="moveRowDown(day,contract)">Bajar</button>
            <input type="text" [(ngModel)]="contract.order" [value]=" i + 1" [hidden]="true">
          </td>
          <td>{{ i + 1 }}</td>
          <td><div class="contract">{{ contract.codContract }}</div></td>
          <td>{{ contract.customer.name }}</td>
          <td>{{ contract.hourIni }}-{{ contract.hourFin }}</td>
          <td>
            <select [(ngModel)]="contract.mobility" (change)="onOptionChangeMobility(contract._id,contract.mobility)" >
              <option value="ROJO">ROJO</option>
              <option value="AZUL">AZUL</option>
              <option value="EDUARDO">EDUARDO</option>
            </select>
          </td>
          <td>{{ contract.district }}</td>
          <td>{{ contract.address }}</td>
          <td><input type="checkbox" [(ngModel)]="contract.isSelected" (change)="onOptionChange(contract._id,contract.isSelected)">Entregado</td>
        </tr>
        <tr>
          <td style="background-color: rgb(0, 255, 60);">Recojo</td>
        </tr>
        <tr *ngFor="let contract of getContractsPikupDateForDay(day); let i = index" [class.yellow-background]="contract.isSelectedPickup">
          <td>
            <button class="btn btn-warning" (click)="moveRowUpPickup(day,contract)">Subir</button>
            <button class="btn btn-warning" (click)="moveRowDownPickup(day,contract)">Bajar</button>
            <input type="number" [(ngModel)]="contract.orderPickup" [value]="i + 1" [hidden]="true">
          </td>
          <td>{{ i + 1 }}</td>
          <td><div class="contract">{{ contract.codContract }}</div></td>
          <td>{{ contract.customer.name }}</td>
          <td>--</td>
          <td>
            <select [(ngModel)]="contract.mobilityPickup" (change)="onOptionChangeMobilityPickup(contract._id,contract.mobilityPickup)" >
              <option value="ROJO">ROJO</option>
              <option value="AZUL">AZUL</option>
              <option value="EDUARDO">EDUARDO</option>
            </select>
          </td>
          <td>{{ contract.district }}</td>
          <td>{{ contract.address }}</td>
          <td><input type="checkbox" [(ngModel)]="contract.isSelectedPickup" (change)="onOptionChangePickup(contract._id,contract.isSelectedPickup)">Recojo</td>
        </tr>
      </ng-container>
    </table>
  </div>
</div>